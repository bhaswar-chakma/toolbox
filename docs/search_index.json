[["tidyr-vs-pandas.html", "3 tidyr vs pandas 3.1 pivot_longer() vs melt() 3.2 pivot_wider vs pivot", " 3 tidyr vs pandas 3.1 pivot_longer() vs melt() Given the following table (life expectancy data) country 1997 2007 Bangladesh 59.4 64.1 Portugal 76.0 78.1 How do we make the table long? Desired output: country year life_exp Bangladesh 1997 59.4 Bangladesh 2007 64.1 Portugal 1997 76.0 Portugal 2007 78.1 tidyr::pivot_longer pandas::melt() # toy data df &lt;- tibble( country = c(&quot;Bangladesh&quot;, &quot;Portugal&quot;), `1997` = c(59.4, 76.0), `2007` = c(64.1, 78.1) ) df ## # A tibble: 2 x 3 ## country `1997` `2007` ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Bangladesh 59.4 64.1 ## 2 Portugal 76 78.1 pivot_longer() in action! # pivot_longer in action df %&gt;% pivot_longer( cols = c(`1997`, `2007`), names_to = &quot;year&quot;, values_to = &quot;life_exp&quot; ) # toy data data = { &#39;country&#39;: [&quot;Bangladesh&quot;, &quot;Portugal&quot;], &#39;1997&#39;: [59.4, 76.0], &#39;2007&#39;: [64.1, 78.1] } df = pd.DataFrame(data) df ## country 1997 2007 ## 0 Bangladesh 59.4 64.1 ## 1 Portugal 76.0 78.1 melt() in action! # melt() in action df.melt( id_vars = &#39;country&#39;, value_vars = [&#39;1997&#39;, &#39;2007&#39;], # cols var_name = &#39;year&#39;, # names_to value_name = &#39;life_exp&#39; # values_to ) 3.2 pivot_wider vs pivot Given the following table country year life_exp Bangladesh 1997 59.4 Bangladesh 2007 64.1 Portugal 1997 76.0 Portugal 2007 78.1 How do we make the table wide? Desired output: country 1997 2007 Bangladesh 59.4 64.1 Portugal 76.0 78.1 tidyr::pivot_wider() pandas::pivot() # toy data country &lt;- c( &quot;Bangladesh&quot;, &quot;Bangladesh&quot;, &quot;Portugal&quot;, &quot;Portugal&quot; ) year &lt;- c( &quot;1997&quot;, &quot;2007&quot;, &quot;1997&quot;, &quot;2007&quot; ) life_exp &lt;- c( 59.4, 64.1, 76, 78.1 ) df &lt;- tibble(country, year, life_exp) df ## # A tibble: 4 x 3 ## country year life_exp ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 Bangladesh 1997 59.4 ## 2 Bangladesh 2007 64.1 ## 3 Portugal 1997 76 ## 4 Portugal 2007 78.1 pivot_wider() in action! # pivot_wider in action df %&gt;% pivot_wider( names_from = &quot;year&quot;, values_from = &quot;life_exp&quot; ) ## # A tibble: 2 x 3 ## country `1997` `2007` ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Bangladesh 59.4 64.1 ## 2 Portugal 76 78.1 # toy data country =[ &quot;Bangladesh&quot;, &quot;Bangladesh&quot;, &quot;Portugal&quot;, &quot;Portugal&quot; ] year = [ &quot;1997&quot;, &quot;2007&quot;, &quot;1997&quot;, &quot;2007&quot; ] life_exp = [ 59.4, 64.1, 76, 78.1 ] df = pd.DataFrame( {&#39;country&#39;: country, &#39;year&#39;: year, &#39;life_exp&#39;: life_exp} ) df ## country year life_exp ## 0 Bangladesh 1997 59.4 ## 1 Bangladesh 2007 64.1 ## 2 Portugal 1997 76.0 ## 3 Portugal 2007 78.1 pivot() in action! # pivot in action df_wide = df.pivot( index = &#39;country&#39;, columns = &#39;year&#39;, # names from values = &#39;life_exp&#39; # vasles from ) df_wide ## year 1997 2007 ## country ## Bangladesh 59.4 64.1 ## Portugal 76.0 78.1 # Reset the names df_wide.index.name = None df_wide.columns.name = None df_wide ## 1997 2007 ## Bangladesh 59.4 64.1 ## Portugal 76.0 78.1 "]]
